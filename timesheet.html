<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Employee Data Management</title>
  <!-- <link rel="stylesheet" type="text/css" href="assets/css/reset.css"> -->
  <link rel="stylesheet" type="text/css" href="employee.css">
   <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script> 


</head>
<body>
    <div class="container">
    <div class="jumbotron" style=" background-color: black;">
  <h1 style="color: white;">Employee Data Management</h1>
</div>

  <!-- Centered Train Schedule --> 
  <center>

  <!-- New Train Form -->

  <div class="card col-lg text-left">
        <div class="card-header">
                Add Employee
        </div>
        <div class="card-body">
                <form role="form" id="form-design">
                        <div class="form-group">
                          <label for="name-input">Employee Name</label><br>
                          <input class="form-control" id="name-input" type="text">
                        </div>
                        <div class="form-group">
                          <label for="role-input">Role</label><br>
                          <input class="form-control" id="role-input" type="text">
                        </div>
                        <div class="form-group">
                          <label for="start-date-input">Start Date</label><br>
                          <input class="form-control" id="start-date-input" type="text">
                        </div>
                        <div class="form-group">
                          <label for="monthly-rate-input">Monthly Rate</label><br>
                          <input class="form-control" id="monthly-rate-input" type="number">
                        </div>
                        <button class="btn btn-default" id="add-employee" type="submit" style="float: right;">ADD</button>
                      </form>
          
        </div>
      </div>
   

<div class="card text-left">
    <div class="card head">Current Employees</div>
    <div class="card body">
<table style="width:80%" id="directory">
        <thead>
      <tr>
        <th id="employee">Employee Name</th>
        <th id="role">Role</th>
        <th id="start">Start Date</th> 
        <th id="months-worked">Months Worked</th>
        <th id="monthly-rate">Monthly Rate($)</th>
        <th id="total-billed">Total Billed($)</th>
      </tr>
      </thead>
         <tbody id="add-employee-row"></tbody>
    </table>
    </center>
</div>
</div>

  <div id="test"></div>
</div>


<script src="https://www.gstatic.com/firebasejs/5.1.0/firebase.js">
</script>
<script>
 // Initialize Firebase

var name="";
var role="";
var startDate="";
var monthlyRate=0;

 var config = {
   apiKey: "AIzaSyDcz2wA7jLD485bsY4P1g7kmo3FQSc0C4Q",
   authDomain: "test-employee-datasheet.firebaseapp.com",
   databaseURL: "https://test-employee-datasheet.firebaseio.com",
   projectId: "test-employee-datasheet",
   storageBucket: "",
   messagingSenderId: "818259485970"
 };
 firebase.initializeApp(config);

var database = firebase.database();



$("#add-employee").on('click',function(){

    name=$("#name-input").val().trim();
    role=$("#role-input").val().trim();
    startDate=$("#startDate-input").val().trim();
    monthlyRate=$("#monthlyRate-input").val().trim();

    database.ref().push({
        name: name,
        role: role,
        startDate: startDate,
        monthlyRate: monthlyRate,
        dateAdded: firebase.database.ServerValue.TIMESTAMP
    });
});

/*
database.ref().on("value", function(snapshot) {

var sv = snapshot.val();

//var svArr = Object.keys(sv);

var lastIndex = svArr.length - 1;

var lastKey = svArr[lastIndex];

var lastObj = sv[lastKey];

console.log(lastObj.name);
console.log(lastObj.role);
console.log(lastObj.startDate);
console.log(lastObj.monthlyRate);
});
*/

database.ref().on("child_added", function(childSnapshot){
    console.log(childSnapshot.val().name);

    var addEmployeeRow = $("#add-employee-row");

var employeeData = "<tr>";
employeeData += "<td>" + childSnapshot.val().name + "</td>";
employeeData += "<td>" + childSnapshot.val().role + "</td>";
employeeData += "<td>" + childSnapshot.val().startDate + "</td>";
employeeData += "<td></td>";
employeeData += "<td>" + childSnapshot.val().monthlyRate + "</td>";
employeeData += "<td></td>";
employeeData += "</tr>";

addEmployeeRow.append(employeeData);

});




</script>
</body>
</html>